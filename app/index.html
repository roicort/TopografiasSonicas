---
layout: default
---

<html>
<head>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
  <script src="https://w.soundcloud.com/player/api.js"></script>

  <script src="node_modules/leaflet-search/src/leaflet-search.js"></script>
  <link rel="stylesheet" href="node_modules/leaflet-search/src/leaflet-search.css">

  <script src="node_modules/leaflet-sidebar/src/L.Control.Sidebar.js"></script>
  <link rel="stylesheet" href="node_modules/leaflet-sidebar/src/L.Control.Sidebar.css">

	<style>
		#map {
			width: 100%;
			height:90vh;
		}
	</style>

	
</head>

<body>

<div id='map'></div>
<div id="sidebar"></div>
<script>

  function loadJSON(callback) {   
    var xobj = new XMLHttpRequest();
    xobj.overrideMimeType("application/json");
    xobj.open('GET', 'data.json', true);
    xobj.onreadystatechange = function () {
      if (xobj.readyState == 4 && xobj.status == "200") {
        callback(JSON.parse(xobj.responseText));
      }
    };
    xobj.send(null);  
  }

  var map = L.map('map');
  map.setView([0, 0], 2.5);

	L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox/light-v9'
	}).addTo(map);

  var sidebar = L.control.sidebar('sidebar', {
    position: 'left'
  });

  map.addControl(sidebar);

  map.on('click', function () {
            sidebar.hide();
        });

  function loadsound(e) {
    url = e.target.feature.properties.url
    var widgetIframe = document.getElementById('sc-widget'),
    widget = SC.Widget(widgetIframe);
    widget.load(url, {show_artwork: false, autoplay: true});
    widget.bind(SC.Widget.Events.READY, function() {
    widget.play()
    });
}

 function deliver(e){
   infopop = "<br>" +
                "<table>" + "<tbody>" +
                "<tr>"+
                "<td>" + "Name: " + "</td>" + 
                "<td>" + e.target.feature.properties.name + "</td>" + 
                "</tr>"+
                "<tr>"+
                "<td>" + "Author: " + "</td>" +
                "<td>" + e.target.feature.properties.author + "</td>" +
                "</tr>"+
                "<tr>"+
                "<td>" + "Location: " + "</td>" +
                "<td>" + e.target.feature.properties.location + "</td>" +
                "</tr>"+
                "<tr>"+
                "<td>" + "Date: " + "</td>" +
                "<td>" + e.target.feature.properties.date + "</td>" +
                "</tr>"+
                "<tr>"+
                "<td>" + "Time: " + "</td>" +
                "<td>" + e.target.feature.properties.time + "</td>" +
                "</tr>"+
                "<tr>"+
                "<td>" + "Equipment: " + "</td>" +
                "<td>" + e.target.feature.properties.equipment + "</td>" +
                "</tr>"+
                "<tr>"+
                "<td>" + "Duration: " + "</td>" +
                "<td>" + e.target.feature.properties.duration + "</td>" +
                "</tr>"+
                "<tr>"+
                "<td>" + "File Ext: " + "</td>" +
                "<td>" + e.target.feature.properties.extension + "</td>" +
                "</tr>"+
                "<tr>"+
                "<td>" + "Sample Rate: " + "</td>" +
                "<td>" + e.target.feature.properties.samplerate + "</td>" +
                "</tr>"+
                "<tr>"+
                "<td>" + "Bitdepth: " + "</td>" +
                "<td>" + e.target.feature.properties.bitdepth + "</td>" +
                "</tr>"+
                "<tr>"+
                "<td>" + "Lat: " + "</td>" +
                "<td>" + e.target.feature.geometry.coordinates[0] + "</td>" +
                "</tr>"+
                "<tr>"+
                "<td>" + "Lon: " + "</td>" +
                "<td>" + e.target.feature.geometry.coordinates[1] + "</td>" +
                "</tr>"+
                "</tbody>"+"</table>"+ "<br>" +
                '<iframe id="sc-widget" src="https://w.soundcloud.com/player/?url=" width="100%" height="130px" scrolling="no" frameborder="no"></iframe>'
   sidebar.setContent(infopop);
   loadsound(e);
   sidebar.show()
   var coordinates = e.target.feature.geometry.coordinates;
   map.flyTo([coordinates[1],coordinates[0]-10],5);
 }

  function onEachFeature(feature, layer) {
    layer.bindPopup(feature.properties.name);
    layer.on({
        click: deliver
    });
    }

  loadJSON(function(json) {
    var featuresLayer = new L.geoJSON(json, {
      onEachFeature: onEachFeature
  }).addTo(map);
  var searchControl = new L.Control.Search({
		layer: featuresLayer,
		propertyName: 'name',
		marker: false,
		moveToLocation: function(coordinates, title, map) {
  	map.flyTo([coordinates.lat,coordinates.lng],5); // access the zoom
		}
	});
	
	map.addControl( searchControl );  //inizialize search control
  });


</script>
</body>
</html>

